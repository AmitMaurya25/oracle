set line 160
set pagesize 50
col file_name for a60
col TABLESPACE_NAME for a25
prompt size 2621504k,

select df.FILE_NAME,df.TABLESPACE_NAME,round(df.BYTES/1024/1024) Allocated,
round(nvl(dfs.BYTES/1024/1024,0)) FREE_SPACE, round(((df.BYTES/1024/1024)-nvl((dfs.BYTES/1024/1024),0))) USED_SPACE
from dba_data_files df,
(select file_id,tablespace_name,sum(bytes) bytes 
	from dba_free_space 
	group by file_id,tablespace_name) dfs 
where df.FILE_ID=dfs.FILE_ID (+)
AND df.TABLESPACE_NAME=upper('&TABLESPACE_NAME')
order by free_space
--substr(df.FILE_NAME,-6,2)
/



--------------------------------------------------------------------------------------------
try.sql  -------------------

colu tspace format A20
colu tot_ts_size format 99999.999
colu free_ts_size format 99999.999
colu used_ts_size format 99999.999
select df.tablespace_name tspace,
    df.bytes/(1024*1024*1024) tot_ts_size,
  (df.bytes/(1024*1024*1024) -sum(fs.bytes)/(1024*1024*1024)) Used_ts_size,
  sum(fs.bytes)/(1024*1024*1024) free_ts_size,
        round(sum(fs.bytes)*100/df.bytes) free_pct,
  round((df.bytes-sum(fs.bytes))*100/df.bytes) used_pct1
from dba_free_space fs, (select tablespace_name, sum(bytes) bytes from dba_data_files  group by tablespace_name ) df
 where fs.tablespace_name = df.tablespace_name
  group by df.tablespace_name, df.bytes 
 order by 1
/
------------------------------------------------------------------------------------------

SQL> select TABLESPACE_NAME,STATUS from dba_tablespaces;
TABLESPACE_NAME STATUS
------------------------------ ---------
SYSTEM ONLINE
SYSAUX ONLINE
UNDOTBS1 ONLINE
TEMP ONLINE
USERS ONLINE

----------------------------------------------------------------------------------
SQL> set lines 200 pages 200
SQL> col FILE_NAME for a50
SQL> select FILE_NAME,TABLESPACE_NAME from dba_data_files;
FILE_NAME TABLESPACE_NAME
-------------------------------------------------- ------------------------------
/u01/oradata/prod/datafile/system01.dbf SYSTEM
/u01/oradata/prod/datafile/sysaux01.dbf SYSAUX
/u01/oradata/prod/datafile/undotbs01.dbf UNDOTBS1
/u01/oradata/prod/datafile/users01.dbf USERS

-----------------------------------------------------------------------

SQL> alter tablespace USERS add datafile '/u01/oradata/prod/datafile/users02.dbf' size 10m;
Tablespace altered.

SQL> alter tablespace USERS add datafile '/u01/oradata/prod/datafile/users04.dbf' size 100m autoextend on;
Tablespace altered.


SQL> alter database datafile '/u01/oradata/prod/datafile/app01.dbf' resize 120m;
Database altered.
SQL> SELECT tablespace_name,file_name, bytes/1024/1024 MB FROM dba_data_files where
tablespace_name='APP';
TABLESPACE_NAME FILE_NAME MB
------------------------------ ------------------------------------------------------------ ----------
APP /u01/oradata/prod/datafile/app01.dbf 120
APP /u01/oradata/prod/datafile/app02.dbf 100


SQL> select FILE_NAME,BYTES/1024/1024,USER_BYTES/1024/1024,AUTOEXTENSIBLE from dba_data_files
where TABLESPACE_NAME='USERS';

FILE_NAME BYTES/1024/1024 USER_BYTES/1024/1024 AUT
------------------------------------------------------------ --------------- -------------------- ---
/u01/oradata/prod/datafile/users01.dbf 200 199 YES
/u01/oradata/prod/datafile/users02.dbf 10 9 NO
/u01/oradata/prod/datafile/users03.dbf 1024 1023 NO

SQL> alter database datafile '/u01/oradata/prod/datafile/users02.dbf' autoextend on;
Database altered.

SQL> select sum(bytes/1024/1024/1024) from dba_segments;

---------------------------------------------------------------------

SQL> alter TABLESPACE USERS read only;
Tablespace altered.
SQL> select TABLESPACE_NAME,STATUS from dba_tablespaces;
TABLESPACE_NAME STATUS
------------------------- ---------
SYSTEM ONLINE
SYSAUX ONLINE
UNDOTBS1 ONLINE
TEMP ONLINE
USERS READ ONLY
SQL>
SQL>
SQL> alter TABLESPACE USERS online;
Tablespace altered.

--------------------------------------------------------------------------------------

SELECT tablespace_name,file_name, bytes/1024/1024 MB FROM dba_data_files;

-------------------------------------------------------------

select USERNAME,DEFAULT_TABLESPACE from dba_users;
SQL> grant create table to john;
alter user john default tablespace app;

SQL> desc dba_sys_privs
Name Null? Type
----------------------------------------- -------- ----------------------------
GRANTEE VARCHAR2(128)
PRIVILEGE VARCHAR2(40)
ADMIN_OPTION VARCHAR2(3)
COMMON VARCHAR2(3)
INHERITED VARCHAR2(3)
SQL> select GRANTEE,PRIVILEGE from dba_sys_privs where GRANTEE='JOHN';
GRAN PRIVILEGE
---- ----------------------------------------
JOHN CREATE TABLE
JOHN CREATE SESSION

SQL> BEGIN
FOR counter IN 1..1000000 loop
INSERT INTO t1(c1)
VALUES(sys_guid());
END loop;
END;
------------------------------------------------
SQL> drop tablespace APP including contents and datafiles;
Tablespace dropped.
SQL> commit;
Commit complete.
SQL> rollback;
Rollback complete.

SQL> show parameter undo
NAME TYPE VALUE
------------------------------------ ----------- ------------------------------
temp_undo_enabled boolean FALSE
undo_management string AUTO
undo_retention integer 900
undo_tablespace string UNDOTBS1
SQL>
SQL>
SQL>
SQL> alter system set undo_retention=1500;
System altered.
SQL>
SQL>
SQL> show parameter undo_retention
NAME TYPE VALUE
------------------------------------ ----------- ------------------------------
undo_retention integer 1500
NAME TYPE VALUE
------------------------------------ ----------- ------------------------------
temp_undo_enabled boolean FALSE
undo_management string AUTO
undo_retention integer 1500
undo_tablespace string UNDO
SQL>